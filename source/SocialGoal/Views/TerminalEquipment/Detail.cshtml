@model SocialGoal.Model.Models.ReceiveDataLast
@{
    ViewBag.Title = "终端详细信息";
}
@section styles{
    <link href="~/Content/css/map.Default.css" rel="stylesheet" />
}
<div id="content">
    <!--
        The ID "widget-grid" will start to initialize all widgets below
        You do not need to use widgets if you dont want to. Simply remove
        the <section></section> and you can use wells or panels instead
        -->
    <!-- widget grid -->
    <section id="widget-grid" class="">
        <!-- row -->
        <div class="row">
            <article class="col-sm-12 col-md-12 col-lg-6">
                <!-- new widget -->
                <div class="jarviswidget" id="wid-id-1" data-widget-colorbutton="false" data-widget-editbutton="false">
                    <!-- widget options:
                    usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">

                    data-widget-colorbutton="false"
                    data-widget-editbutton="false"
                    data-widget-togglebutton="false"
                    data-widget-deletebutton="false"
                    data-widget-fullscreenbutton="false"
                    data-widget-custombutton="false"
                    data-widget-collapsed="true"
                    data-widget-sortable="false"

                    -->
                    <header>
                        <span class="widget-icon"> <i class="fa fa-map-marker"></i> </span>
                        <h2>地图全屏</h2>
                        <div class="widget-toolbar hidden-mobile">
                            <span class="onoffswitch-title"><i class="fa fa-history"></i>@Html.ActionLink("轨迹回放", "Map", "Terminal", new { @id = Model.DevId }, null)</span>

                        </div>
                    </header>
                    <!-- widget div-->
                    <div id="GetWidgetBodyHeight">
                        <!-- widget edit box -->
                        <div class="jarviswidget-editbox">
                            <div>
                                <label>Title:</label>
                                <input type="text" />
                            </div>
                        </div>
                        <!-- end widget edit box -->
                        <div class="widget-body no-padding">
                            <div class="widget-body-toolbar">
                                <ul class="list-unstyled list-inline">
                                    <li>
                                        <i class="  icon-map-marker"></i>
                                        当前位置：@Model.GpsPos
                                    </li>
                                    <li>
                                        <i class=" icon-ellipsis-horizontal"></i>
                                        纬度：@Model.GpsPlat
                                    </li>
                                    <li>
                                        <i class=" icon-ellipsis-horizontal"></i>
                                        经度：@Model.GpsPlog
                                    </li>
                                    <li>
                                        <i class="icon-rocket"></i>
                                        速度：@Model.GpsSpeed
                                    </li>
                                    <li>
                                        <i class="icon-stackexchange"></i>
                                        方向：@Model.GpsDirection
                                    </li>                                  
                                    <li class="text-success">
                                        <i class="icon-map-marker"></i>
                                        GPS定位时间：@Model.GpsTime
                                    </li>
                                </ul>
                            </div>

                            <div class="widget-body-toolbar">
                                <div class="row">
                                    <div class="col-sm-4">
                                        <div class="dropdown">
                                            <a id="dLabel" role="button" data-toggle="dropdown" class="btn btn-primary" data-target="#" href="javascript:void(0);"> 电子围栏 <span class="caret"></span> </a>
                                            <ul class="dropdown-menu multi-level" role="menu">
                                                <li>
                                                    <a href="javascript:SetCircle();">圆形自定义</a>
                                                </li>
                                                <li class="divider"></li>
                                                <li>
                                                    <a href="javascript:SetPolygon(0);">多边形自定义</a>
                                                </li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="col-sm-8">
                                        <div id="resultInfo" ></div>
                                    </div>
                                </div>
                            </div>
                            <!-- content goes here -->
                            <div id="iCenter"></div>
                            <div class="row">
                                <div class="col-sm-12">
                                    <div class="box box-transparent box-nomargin">
                                        <div class="box-header">
                                            <div class="actions">
                                                <a class="btn box-remove btn-xs btn-link" href="#">
                                                    <i class="icon-remove"></i>
                                                </a>

                                                <a class="btn box-collapse btn-xs btn-link" href="#">
                                                    <i></i>
                                                </a>
                                            </div>
                                        </div>
                                        <div class="box-content" id="result">

                                        </div>
                                    </div>
                                </div>

                            </div>
                            <div class="widget-footer">
                            </div>
                            <!-- end content -->
                        </div>
                    </div>
                    <!-- end widget div -->
                </div>
                <!-- end widget -->
            </article>
            <article class="col-sm-12 col-md-12 col-lg-6">
                <!-- new widget -->
                <div class="jarviswidget" id="wid-id-2" data-widget-editbutton="false" ng-app="ui.bootstrap.commond">
                    <!-- widget options:
                    usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">

                    data-widget-colorbutton="false"
                    data-widget-editbutton="false"
                    data-widget-togglebutton="false"
                    data-widget-deletebutton="false"
                    data-widget-fullscreenbutton="false"
                    data-widget-custombutton="false"
                    data-widget-collapsed="true"
                    data-widget-sortable="false"

                    -->
                    <header>
                        <span class="widget-icon"> <i class="fa fa-comments"></i> </span>
                        <h2>终端控制 </h2>
                    </header>
                    <!-- widget div-->
                    <div>
                        <!-- widget edit box -->
                        <div class="jarviswidget-editbox">
                            <div>
                                <label>Title:</label>
                                <input type="text" />
                            </div>
                        </div>
                        <!-- end widget edit box -->
                        <div class="widget-body no-padding" ng-controller="TabsCmdCtrl">
                            <div class="well well-sm well-light">
                                <tabset>
                                    <tab heading="无线智能终端v1.0">
                                        <form class="smart-form">
                                            <header>
                                                参数设置
                                            </header>
                                            <fieldset>
                                                <section>
                                                    <label class="label">地址类型：</label>
                                                    <div class="inline-group">
                                                        <label class="radio">
                                                            <input type="radio" name="AddressType" checked="checked">
                                                            <i></i>不改变
                                                        </label>
                                                        <label class="radio">
                                                            <input type="radio" name="AddressType">
                                                            <i></i>域名
                                                        </label>
                                                        <label class="radio">
                                                            <input type="radio" name="AddressType">
                                                            <i></i>Ip地址
                                                        </label>
                                                    </div>
                                                </section>
                                                <section>
                                                    <label class="label">地址：</label>
                                                    <label class="input">
                                                        <input type="text" maxlength="10" value="123.57.41.22:9001">
                                                    </label>
                                                    <div class="note">
                                                        <strong>备注：</strong> 123.57.41.22:9001 ；www.xsgps.com:9001。
                                                    </div>
                                                </section>
                                                <section>
                                                    <label class="label">更改终端工作状态：</label>
                                                    <div class="inline-group">
                                                        <label class="radio">
                                                            <input type="radio" value="00" name="Activation" checked="checked">
                                                            <i></i>不改变
                                                        </label>
                                                        <label class="radio">
                                                            <input type="radio" value="01" name="Activation">
                                                            <i></i>测试
                                                        </label>
                                                        <label class="radio">
                                                            <input type="radio" value="02" name="Activation">
                                                            <i></i>待激活
                                                        </label>
                                                        <label class="radio">
                                                            <input type="radio" value="03" name="Activation">
                                                            <i></i>已激活
                                                        </label>
                                                    </div>
                                                </section>
                                                <section>
                                                    <label class="label">累计工时：</label>
                                                    <label class="input">
                                                        <input type="text" maxlength="10">
                                                    </label>
                                                    <div class="note">
                                                        <strong>功能描述：</strong> 修正终端累计工时。
                                                    </div>
                                                </section>

                                            </fieldset>
                                            <fieldset>
                                                <section>
                                                    <label class="label">工作模式：</label>
                                                    <div class="inline-group">
                                                        <label class="radio">
                                                            <input type="radio" name="gzms" checked="checked">
                                                            <i></i>不改变
                                                        </label>
                                                        <label class="radio">
                                                            <input type="radio" name="gzms">
                                                            <i></i>标准模式
                                                        </label>
                                                        <label class="radio">
                                                            <input type="radio" name="gzms">
                                                            <i></i>精准模式
                                                        </label>
                                                        <label class="radio">
                                                            <input type="radio" name="gzms">
                                                            <i></i>追车模式
                                                        </label>
                                                    </div>
                                                </section>
                                                <section>
                                                    <label class="label">定时时间：</label>
                                                    <label class="select">
                                                        <select id="dssjs" name="dssjs">
                                                            <option value="0">不设置</option>
                                                            <option value="8">8:00</option>
                                                            <option value="9">9:00</option>
                                                            <option value="10">10:00</option>
                                                            <option value="11">11:00</option>
                                                            <option value="12">12:00</option>
                                                            <option value="13">13:00</option>
                                                            <option value="14">14:00</option>
                                                            <option value="15">15:00</option>
                                                            <option value="16">16:00</option>
                                                            <option value="17">17:00</option>
                                                            <option value="18">18:00</option>
                                                            <option value="19">19:00</option>
                                                            <option value="20">20:00</option>
                                                            <option value="21">21:00</option>
                                                            <option value="22">22:00</option>
                                                            <option value="23">23:00</option>
                                                            <option value="24">00:00</option>
                                                            <option value="1">1:00</option>
                                                            <option value="2">2:00</option>
                                                            <option value="3">3:00</option>
                                                            <option value="4">4:00</option>
                                                            <option value="5">5:00</option>
                                                            <option value="6">6:00</option>
                                                            <option value="7">7:00</option>
                                                        </select>
                                                        <i></i>
                                                    </label>
                                                    <div class="note">
                                                        <strong>功能描述：</strong>终端每天第一次上报位置信息的时间。
                                                    </div>
                                                </section>
                                                <section>
                                                    <label class="label">定位次数</label>
                                                    <label class="input">
                                                        <input type="text" maxlength="10">
                                                    </label>
                                                    <div class="note">
                                                        <strong>功能描述：</strong> 终端数据上传定位数据的次数，以天为单位。
                                                    </div>
                                                </section>
                                                <section>
                                                    <label class="label">工作时间</label>
                                                    <label class="input">
                                                        <input type="text" maxlength="10">
                                                    </label>
                                                    <div class="note">
                                                        <strong>功能描述：</strong> 终端每次启动后工作时间。（终端只有在该时间段内处于工作状态，其他时间处在深度睡眠状态。
                                                    </div>
                                                </section>
                                                <section>
                                                    <label class="label">间隔时间</label>
                                                    <label class="input">
                                                        <input type="text" maxlength="10">
                                                    </label>
                                                    <div class="note">
                                                        <strong>功能描述：</strong> 通过定位次数以天为单位进行折算，不需要设置。
                                                    </div>
                                                </section>
                                            </fieldset>
                                            <fieldset>
                                                <section>
                                                    <ul class="list-unstyled">
                                                        <li><i class="fa fa-warning text-warning"></i> 设备出厂时，默认上传位置信息的频率为 1次/天</li>
                                                        <li class="text-success"><i class="fa fa fa-bell text-danger"></i><strong>为延长设备的使用寿命：标准模式、精准模式设置次数不得超过 24次/天（1次/小时）；追车模式下数据发送间隔最小60秒最大3600秒;0为不设置。</strong> </li>
                                                        <li><i class="fa fa-warning text-warning"></i> 在下次信息回传前，向设备发送多条命令信息，只有最后一条命令有效。</li>
                                                    </ul>
                                                </section>
                                            </fieldset>
                                            <footer>
                                                <button type="submit" class="btn btn-primary">
                                                    设置参数
                                                </button>
                                                <button type="submit" class="btn btn-primary">
                                                    激活
                                                </button>
                                            </footer>
                                        </form>
                                    </tab>
                                    <tab heading="有线智能终端v1.0">



                                    </tab>
                                    @*<tab ng-repeat="tab in tabs" heading="{{tab.title}}" active="tab.active" disabled="tab.disabled">
                                            {{tab.content}}
                                        </tab>*@
                                </tabset>
                            </div>
                        </div>
                    </div>
                    <!-- end widget div -->
                </div>
                <!-- end widget -->
                <!-- new widget -->
                <div class="jarviswidget" id="wid-id-3" data-widget-editbutton="false" data-widget-fullscreenbutton="false">
                    <!-- widget options:
                    usage: <div class="jarviswidget" id="wid-id-0" data-widget-editbutton="false">
                    data-widget-colorbutton="false"
                    data-widget-editbutton="false"
                    data-widget-togglebutton="false"
                    data-widget-deletebutton="false"
                    data-widget-fullscreenbutton="false"
                    data-widget-custombutton="false"
                    data-widget-collapsed="true"
                    data-widget-sortable="false"
                    -->
                    <header>
                        <span class="widget-icon"> <i class="fa fa-comments"></i> </span>
                        <h2> 运行记录 </h2>
                        <div class="widget-toolbar">
                            <!-- add: non-hidden - to disable auto hide -->
                            <div class="btn-group">
                                <button class="btn dropdown-toggle btn-xs btn-success" data-toggle="dropdown">
                                    Status <i class="fa fa-caret-down"></i>
                                </button>
                                <ul class="dropdown-menu pull-right js-status-update">
                                    <li>
                                        <a href="javascript:void(0);"><i class="fa fa-circle txt-color-green"></i> Online</a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);"><i class="fa fa-circle txt-color-red"></i> Busy</a>
                                    </li>
                                    <li>
                                        <a href="javascript:void(0);"><i class="fa fa-circle txt-color-orange"></i> Away</a>
                                    </li>
                                    <li class="divider"></li>
                                    <li>
                                        <a href="javascript:void(0);"><i class="fa fa-power-off"></i> Log Off</a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </header>
                    <!-- widget div-->
                    <div>
                        <!-- widget edit box -->
                        <div class="jarviswidget-editbox">
                            <div>
                                <label>Title:</label>
                                <input type="text" />
                            </div>
                        </div>
                        <!-- end widget edit box -->
                        <div class="widget-body no-padding">
                            <div class="widget-body-toolbar"></div>
                            <div class="table-responsive">
                                <div class="row">
                                    <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12" style="display:none">
                                        <div class="well well-sm">
                                            <!-- Timeline Content -->
                                            <div class="smart-timeline">
                                                <ul class="smart-timeline-list">
                                                    <li>
                                                        <div class="smart-timeline-icon">
                                                            <img src="~/Content/ICON/carblue.png" width="32" height="32" alt="car" />
                                                        </div>
                                                        <div class="smart-timeline-time">
                                                            <small>just now</small>
                                                        </div>
                                                        <div class="smart-timeline-content">
                                                            <p>
                                                                <a href="javascript:void(0);"><strong>Trip to Adalaskar</strong></a>
                                                            </p>
                                                            <p>
                                                                Check out my tour to Adalaskar
                                                            </p>
                                                            <p>
                                                                <a href="javascript:void(0);" class="btn btn-xs btn-primary"><i class="fa fa-file"></i> Read the post</a>
                                                            </p>
                                                            <img src="/Content/img/superbox/superbox-thumb-4.jpg" alt="img" width="150">

                                                        </div>
                                                    </li>
                                                    <li>
                                                        <div class="smart-timeline-icon">
                                                            <i class="fa fa-file-text"></i>
                                                        </div>
                                                        <div class="smart-timeline-time">
                                                            <small>1 min ago</small>
                                                        </div>
                                                        <div class="smart-timeline-content">
                                                            <p>
                                                                <strong>Meeting invite for "GENERAL GNU" [<a href="javascript:void(0);"><i>Go to my calendar</i></a>]</strong>
                                                            </p>
                                                            <div class="well well-sm display-inline">
                                                                <p>Will you be able to attend the meeting - <strong> 10:00 am</strong> tomorrow?</p>
                                                                <button class="btn btn-xs btn-default">Confirm Attendance</button>
                                                            </div>
                                                        </div>
                                                    </li>
                                                    <li>
                                                        <div class="smart-timeline-icon bg-color-greenDark">
                                                            <i class="fa fa-android"></i>
                                                        </div>
                                                        <div class="smart-timeline-time">
                                                            <small>5 hrs ago</small>
                                                        </div>
                                                        <div class="smart-timeline-content">
                                                            <p>
                                                                <strong class="txt-color-greenDark">24hrs User Feed</strong>
                                                            </p>
                                                            <div class="sparkline"
                                                                 data-sparkline-type="compositeline"
                                                                 data-sparkline-spotradius-top="5"
                                                                 data-sparkline-color-top="#3a6965"
                                                                 data-sparkline-line-width-top="3"
                                                                 data-sparkline-color-bottom="#2b5c59"
                                                                 data-sparkline-spot-color="#2b5c59"
                                                                 data-sparkline-minspot-color-top="#97bfbf"
                                                                 data-sparkline-maxspot-color-top="#c2cccc"
                                                                 data-sparkline-highlightline-color-top="#cce8e4"
                                                                 data-sparkline-highlightspot-color-top="#9dbdb9"
                                                                 data-sparkline-width="170px"
                                                                 data-sparkline-height="40px"
                                                                 data-sparkline-line-val="[6,4,7,8,4,3,2,2,5,6,7,4,1,5,7,9,9,8,7,6]"
                                                                 data-sparkline-bar-val="[4,1,5,7,9,9,8,7,6,6,4,7,8,4,3,2,2,5,6,7]"></div>
                                                            <br>
                                                        </div>
                                                    </li>
                                                    <li>
                                                        <div class="smart-timeline-icon">
                                                            <i class="fa fa-user"></i>
                                                        </div>
                                                        <div class="smart-timeline-time">
                                                            <small>yesterday</small>
                                                        </div>
                                                        <div class="smart-timeline-content">
                                                            <p>
                                                                <a href="javascript:void(0);"><strong>Update user information</strong></a>
                                                            </p>
                                                            <p>
                                                                Curabitur ullamcorper ultricies nisi. Nam eget dui. Etiam rhoncus. Maecenas tempus, tellus eget condimentum rhoncus, sem quam semper libero, sit amet adipiscing sem neque sed ipsum. Nam quam nunc, blandit vel, luctus pulvinar, hendrerit id, lorem. Maecenas nec odio et ante tincidunt tempus. Donec vitae sapien ut libero venenatis faucibus.
                                                            </p>
                                                            Tellus eget condimentum rhoncus, sem quam semper libero, sit amet adipiscing sem neque sed ipsum. Nam quam nunc, blandit

                                                            <ul class="list-inline">
                                                                <li>
                                                                    <img src="/Content/img/superbox/superbox-thumb-6.jpg" alt="img" width="50">
                                                                </li>
                                                                <li>
                                                                    <img src="/Content/img/superbox/superbox-thumb-5.jpg" alt="img" width="50">
                                                                </li>
                                                                <li>
                                                                    <img src="/Content/img/superbox/superbox-thumb-7.jpg" alt="img" width="50">
                                                                </li>
                                                            </ul>
                                                        </div>
                                                    </li>
                                                    <li>
                                                        <div class="smart-timeline-icon">
                                                            <i class="fa fa-pencil"></i>
                                                        </div>
                                                        <div class="smart-timeline-time">
                                                            <small>12 Mar, 2013</small>
                                                        </div>
                                                        <div class="smart-timeline-content">
                                                            <p>
                                                                <a href="javascript:void(0);"><strong>Nabi Resource Report</strong></a>
                                                            </p>
                                                            <p>
                                                                Ean vulputate eleifend tellus. Aenean leo ligula, porttitor eu, consequat vitae, eleifend ac, enim. Aliquam lorem ante, dapibus in, viverra quis.
                                                            </p>
                                                            <a href="javascript:void(0);" class="btn btn-xs btn-default">Read more</a>
                                                        </div>
                                                    </li>
                                                    <li class="text-center">
                                                        <a href="javascript:void(0)" class="btn btn-sm btn-default"><i class="fa fa-arrow-down text-muted"></i> LOAD MORE</a>
                                                    </li>
                                                </ul>
                                            </div>
                                            <!-- END Timeline Content -->
                                        </div>
                                    </div>
                                </div>

                            </div>

                            <div class="widget-footer">
                            </div>
                        </div>
                    </div>
                    <!-- end widget div -->
                </div>
                <!-- end widget -->
            </article>
        </div>
        <!-- end row -->
    </section>
    <!-- end widget grid -->
</div>

@section scripts{
    <script language="javascript" src="http://webapi.amap.com/maps?v=1.3&key=990f8ec17963b0c7a507f9c74d275568"></script>
    <script src="~/Scripts/angular-animate.js"></script>
    <script src="~/Scripts/angular-strap.min.js"></script>
    <script src="~/Scripts/angular-strap.tpl.min.js"></script>
    <script src="~/Scripts/AngularCtrlJs/ui.bootstrap.commond.js"></script>

    <script language="javascript">
        var mapObj, marker, ruler2, circle, editorCircle, polylineEditor, mouseTool, drawObj;
        $(document).ready(function () {
            mapInit();
            //初始化按钮状态
            $('#connectButton').removeAttr("disabled");
            $('#disconnectButton').removeAttr("disabled");
            $('#tabs').tabs();
        });
        //初始化地图对象，加载地图
        function mapInit() {
            mapObj = new AMap.Map("iCenter", {
                //二维地图显示视口
                view: new AMap.View2D({
                    // center: new AMap.LngLat(116.397428, 39.90923),//地图中心点
                    zoom: 17 //地图显示的缩放级别
                }),
                continuousZoomEnable: false
            });
            //地图类型切换
            mapObj.plugin(["AMap.MapType"], function () {
                var type = new AMap.MapType({ defaultType: 0 });//初始状态使用2D地图
                mapObj.addControl(type);
            });
            //加载比例尺插件
            mapObj.plugin(["AMap.Scale"], function () {
                scale = new AMap.Scale();
                mapObj.addControl(scale);
            });
            //在地图中添加ToolBar插件
            mapObj.plugin(["AMap.ToolBar"], function () {
                toolBar = new AMap.ToolBar();
                mapObj.addControl(toolBar);
            });
            //在地图中添加鹰眼插件
            mapObj.plugin(["AMap.OverView"], function () {
                //加载鹰眼
                overView = new AMap.OverView({
                    visible: true //初始化隐藏鹰眼
                });
                mapObj.addControl(overView);
            });
            //拉大地图
            var rectOptions = {
                strokeStyle: "dashed",
                strokeColor: "#FF33FF",
                fillColor: "#FF99FF",
                fillOpacity: 0.5,
                strokeOpacity: 1,
                strokeWeight: 2
            };
            //mapObj.plugin(["AMap.MouseTool"], function () {
            //    mouseTool = new AMap.MouseTool(mapObj);
            //    mouseTool.rectZoomIn(rectOptions);     //通过rectOptions更改拉框放大时鼠标绘制的矩形框样式
            //});
            mapObj.plugin(["AMap.RangingTool"], function () {

                var lOptions = {
                    strokeStyle: "solid",
                    strokeColor: "#FF33FF",
                    strokeOpacity: 1,
                    strokeWeight: 2
                };
                var sMarker = {
                    icon: new AMap.Icon({    //复杂图标
                        size: new AMap.Size(28, 37),//图标大小
                        image: "http://webapi.amap.com/images/custom_a_j.png", //大图地址
                        imageOffset: new AMap.Pixel(0, 0)//相对于大图的取图位置
                    })
                };
                var eMarker = {
                    icon: new AMap.Icon({    //复杂图标
                        size: new AMap.Size(28, 37),//图标大小
                        image: "http://webapi.amap.com/images/custom_a_j.png", //大图地址
                        imageOffset: new AMap.Pixel(-28, 0)//相对于大图的取图位置
                    }),
                    offset: new AMap.Pixel(-16, -35)
                };
                var rulerOptions = { startMarkerOptions: sMarker, endMarkerOptions: eMarker, lineOptions: lOptions };
                ruler2 = new AMap.RangingTool(mapObj, rulerOptions);
            });
            //自动加点
            geocoder();
        }
        //添加点标记
        function addMarker(LngLatX, LngLatY) {
            //var LngLatX = "116.405467"; //获取Lng值
            //var LngLatY = "39.907761"; //获取Lat值
            marker = new AMap.Marker({
                // icon: "http://webapi.amap.com/images/marker_sprite.png",
                position: new AMap.LngLat(LngLatX, LngLatY)
            });
            marker.setMap(mapObj);  //在地图上添加点
            marker.setAnimation('AMAP_ANIMATION_BOUNCE'); //设置点标记的动画效果，此处为弹跳效果
            mapObj.setFitView(); //调整到合理视野
        }
        function startRuler() {
            ruler2.turnOn();
        }

        //已知点坐标
        var lnglatXY = new AMap.LngLat('@Model.GpsPlog', '@Model.GpsPlat');
        function geocoder() {
            var MGeocoder;
            //加载地理编码插件
            mapObj.plugin(["AMap.Geocoder"], function () {
                MGeocoder = new AMap.Geocoder({
                    radius: 1000,
                    extensions: "all"
                });
                //返回地理编码结果
                AMap.event.addListener(MGeocoder, "complete", geocoder_CallBack);
                //逆地理编码
                MGeocoder.getAddress(lnglatXY);
            });
            //设置地图中心点及缩放级别
            mapObj.setZoomAndCenter(14, lnglatXY);
            //加点
            var marker = new AMap.Marker({
                map: mapObj,
                icon: new AMap.Icon({
                    image: "../../Content/ICON/car01.png",
                    size: new AMap.Size(51, 51),
                    imageOffset: new AMap.Pixel(-0, -0)
                }),
                position: lnglatXY,
                offset: new AMap.Pixel(-5, -53)
            });
            mapObj.setFitView();
        }
        //鼠标划过显示相应点
        var marker;
        function onMouseOver(e) {
            var coor = e.split(','),
                lnglat = new AMap.LngLat(coor[0], coor[1]);
            if (!marker) {
                marker = new AMap.Marker({
                    map: mapObj,
                    icon: "http://webapi.amap.com/images/0.png",
                    position: lnglat,
                    offset: new AMap.Pixel(-10, -34)
                });
            } else {
                marker.setPosition(lnglat);
            }
            mapObj.setFitView();
        }
        //回调函数
        function geocoder_CallBack(data) {
            var resultStr = "";
            var roadinfo = "";
            var poiinfo = "";
            var address;
            //返回地址描述
            address = data.regeocode.formattedAddress;
            //返回周边道路信息
            roadinfo += "<table class='table table-bordered table-hover table-condensed'>";
            for (var i = 0; i < data.regeocode.roads.length; i++) {

                roadinfo += "<tr><td>道路：" + data.regeocode.roads[i].name + "</td><td>方向：" + data.regeocode.roads[i].direction + "</td><td>距离：" + data.regeocode.roads[i].distance + "米</td></tr>";
            }
            roadinfo += "</table>"
            //返回周边兴趣点信息
            poiinfo += "<table  class='table table-bordered table-hover table-condensed'>";
            for (var j = 0; j < data.regeocode.pois.length; j++) {

                poiinfo += "<tr onmouseover='onMouseOver(\"" + data.regeocode.pois[j].location.toString() + "\")'><td>兴趣点：" + data.regeocode.pois[j].name + "</td><td>类型：" + data.regeocode.pois[j].type + "</td><td>距离：" + data.regeocode.pois[j].distance + "米</td></tr>";
            }
            poiinfo += "</table>";
            //返回结果拼接输出
            resultStr = "<span class='text-info'>地址：" + address + "</span></br/><span class='text-info'>周边道路信息</span>" + roadinfo + "<span class='text-info'>周边兴趣点信息</span>" + poiinfo + "";
            document.getElementById("result").innerHTML = resultStr;
        }
        //绘制圆形围栏
        function SetCircle() {
            ClearOverlay();
            circle = new AMap.Circle({
                center: lnglatXY,// 圆心位置
                radius: 1000, //半径
                strokeColor: "#F33", //线颜色
                strokeOpacity: 1, //线透明度
                strokeWeight: 3, //线粗细度
                fillColor: "#ee2200", //填充颜色
                fillOpacity: 0.35//填充透明度
            });
            circle.setMap(mapObj);

            //添加圆编辑控件
            mapObj.plugin(["AMap.CircleEditor"], function () {
                editorCircle = new AMap.CircleEditor(mapObj, circle);
                AMap.event.addListener(editorCircle, "move", function (e) {
                    document.getElementById('resultInfo').innerHTML = "圆心位置：" + e.lnglat;

                });
                AMap.event.addListener(editorCircle, "adjust", function (e) {
                    document.getElementById('resultInfo').innerHTML = "圆半径：" + e.radius;
                });
            });
            //使圆形覆盖物可编辑
            editorCircle.open();
        }
        //多边形绘制
        function SetPolygon() {
            ClearOverlay();
            //设置多边形的属性
            var polygonOption = {
                strokeColor: "#FF33FF",
                strokeOpacity: 1,
                strokeWeight: 2
            };
            //在地图中添加MouseTool插件
            mapObj.plugin(["AMap.MouseTool"], function () {
                mouseTool = new AMap.MouseTool(mapObj);
                mouseTool.polygon(polygonOption);   //使用鼠标工具绘制多边形
                AMap.event.addListener(mouseTool, "draw", function (e) {
                    drawObj = e.obj;  //obj属性就是绘制完成的覆盖物对象。
                    mapObj.plugin(["AMap.PolyEditor"], function () {
                        //取消鼠标绘制
                        mouseTool.close();

                        polylineEditor = new AMap.PolyEditor(mapObj, drawObj);
                        polylineEditor.open();
                        AMap.event.addListener(polylineEditor, "addnode", function (e) {
                            document.getElementById('resultInfo').innerHTML = "发生事件时光标所在处的经纬度坐标：" + e.lnglat;// + ",发生事件的目标对象:" + e.target;
                        });
                        AMap.event.addListener(polylineEditor, "adjust", function (e) {
                            document.getElementById('resultInfo').innerHTML = "发生事件时光标所在处的经纬度坐标：" + e.lnglat;// + ",发生事件的目标对象:" + e.target;
                        });
                        AMap.event.addListener(polylineEditor, "removenode", function (e) {
                            document.getElementById('resultInfo').innerHTML = "发生事件时光标所在处的经纬度坐标：" + e.lnglat;// + ",发生事件的目标对象:" + e.target;
                        });
                    });

                    var pointsCount = e.obj.getPath().length; //获取节点个数
                    document.getElementById('resultInfo').innerHTML = "多边形节点数：" + pointsCount + "<br>节点坐标：" + e.obj.getPath();
                });
            });
        }

        //清空覆盖物
        function ClearOverlay() {
            if (circle != null && editorCircle != null) {
                circle.setMap(null);
                editorCircle.close();
            }
            if (polylineEditor != null) {
                polylineEditor.close();
                drawObj.setMap(null);
                polylineEditor.close();
                mouseTool.close();
            }

        }
    </script>
}